# start of test: test for interleaving multiple prepared statements
{"resource":"credentials","action":"create","credentialId":"test"}
{"resource":"session","action":"create","sessionId":"testPstmt"}
# creating tables
{"resource":"statement","action":"execute","statementId":"ddl","sql":"DROP TABLE IF EXISTS test1"}
{"resource":"statement","action":"execute","statementId":"ddl","sql":"CREATE TABLE test1 (int_col INT,varchar_col VARCHAR(20),char_col CHAR(20),varchar_col2 VARCHAR(20))"}
{"resource":"statement","action":"execute","statementId":"ddl","sql":"DROP TABLE IF EXISTS test2"}
{"resource":"statement","action":"execute","statementId":"ddl","sql":"CREATE TABLE test2 (int_col INT,int_col2 INT,varchar_col VARCHAR(20))"}
{"resource":"statement","action":"close","statementId":"ddl"}
# insert initial data... switching off between two insert pstmts
{"resource":"preparedStatement","action":"create","statementId":"pstmt1","sql":"INSERT INTO test1 VALUES (?,?,?,?)"}
{"resource":"preparedStatement","action":"create","statementId":"pstmt2","sql":"INSERT INTO test2 VALUES (?,?,?)"}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":93},{"index":2,"type":"VARCHAR","value":"Vermont"},{"index":3,"type":"CHAR","value":"Michigan            "},{"index":4,"type":"VARCHAR","value":"South Dakota"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":88},{"index":2,"type":"INT","value":79},{"index":3,"type":"VARCHAR","value":"Tennessee"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":94},{"index":2,"type":"VARCHAR","value":"Virgina"},{"index":3,"type":"CHAR","value":"Minnesota           "},{"index":4,"type":"VARCHAR","value":"Tennessee"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":89},{"index":2,"type":"INT","value":80},{"index":3,"type":"VARCHAR","value":"Texas"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":95},{"index":2,"type":"VARCHAR","value":"Washington"},{"index":3,"type":"CHAR","value":"Mississippi         "},{"index":4,"type":"VARCHAR","value":"Texas"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":90},{"index":2,"type":"INT","value":81},{"index":3,"type":"VARCHAR","value":"Utah"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":96},{"index":2,"type":"VARCHAR","value":"West Virginia"},{"index":3,"type":"CHAR","value":"Missouri            "},{"index":4,"type":"VARCHAR","value":"Utah"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":91},{"index":2,"type":"INT","value":82},{"index":3,"type":"VARCHAR","value":"Vermont"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":97},{"index":2,"type":"VARCHAR","value":"Wisconsin"},{"index":3,"type":"CHAR","value":"Alabama             "},{"index":4,"type":"VARCHAR","value":"Vermont"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":92},{"index":2,"type":"INT","value":83},{"index":3,"type":"VARCHAR","value":"Virgina"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":98},{"index":2,"type":"VARCHAR","value":"Wyoming"},{"index":3,"type":"CHAR","value":"Alaska              "},{"index":4,"type":"VARCHAR","value":"Virgina"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":93},{"index":2,"type":"INT","value":84},{"index":3,"type":"VARCHAR","value":"Washington"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":99},{"index":2,"type":"VARCHAR","value":"Montana"},{"index":3,"type":"CHAR","value":"Arizona             "},{"index":4,"type":"VARCHAR","value":"Washington"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":94},{"index":2,"type":"INT","value":85},{"index":3,"type":"VARCHAR","value":"West Virginia"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":0},{"index":2,"type":"VARCHAR","value":"Nebraska"},{"index":3,"type":"CHAR","value":"Arkansas            "},{"index":4,"type":"VARCHAR","value":"West Virginia"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":95},{"index":2,"type":"INT","value":86},{"index":3,"type":"VARCHAR","value":"Wisconsin"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":1},{"index":2,"type":"VARCHAR","value":"Nevada"},{"index":3,"type":"CHAR","value":"California          "},{"index":4,"type":"VARCHAR","value":"Wisconsin"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":96},{"index":2,"type":"INT","value":87},{"index":3,"type":"VARCHAR","value":"Wyoming"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":2},{"index":2,"type":"VARCHAR","value":"New Hampshire"},{"index":3,"type":"CHAR","value":"Colorado            "},{"index":4,"type":"VARCHAR","value":"Wyoming"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":97},{"index":2,"type":"INT","value":88},{"index":3,"type":"VARCHAR","value":"Montana"}]}
# add third pstmt for query, interleaving that with some more inserts
# pstmt1 = insert on table1, pstmt2 = insert on table2, pstmt3 = query on table2
{"resource":"preparedStatement","action":"create","statementId":"pstmt3","sql":"select * from test2"}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":28},{"index":2,"type":"INT","value":19},{"index":3,"type":"VARCHAR","value":"New York"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt3","expectedResults":[{"int_col":88,"int_col2":79,"varchar_col":"Tennessee"},{"int_col":89,"int_col2":80,"varchar_col":"Texas"},{"int_col":90,"int_col2":81,"varchar_col":"Utah"},{"int_col":91,"int_col2":82,"varchar_col":"Vermont"},{"int_col":92,"int_col2":83,"varchar_col":"Virgina"},{"int_col":93,"int_col2":84,"varchar_col":"Washington"},{"int_col":94,"int_col2":85,"varchar_col":"West Virginia"},{"int_col":95,"int_col2":86,"varchar_col":"Wisconsin"},{"int_col":96,"int_col2":87,"varchar_col":"Wyoming"},{"int_col":97,"int_col2":88,"varchar_col":"Montana"},{"int_col":28,"int_col2":19,"varchar_col":"New York"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"INT","value":34},{"index":2,"type":"VARCHAR","value":"Oklahoma"},{"index":3,"type":"CHAR","value":"Illinois            "},{"index":4,"type":"VARCHAR","value":"New York"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","bindings":[{"index":1,"type":"INT","value":29},{"index":2,"type":"INT","value":20},{"index":3,"type":"VARCHAR","value":"North Carolina"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt3","expectedResults":[{"int_col":88,"int_col2":79,"varchar_col":"Tennessee"},{"int_col":89,"int_col2":80,"varchar_col":"Texas"},{"int_col":90,"int_col2":81,"varchar_col":"Utah"},{"int_col":91,"int_col2":82,"varchar_col":"Vermont"},{"int_col":92,"int_col2":83,"varchar_col":"Virgina"},{"int_col":93,"int_col2":84,"varchar_col":"Washington"},{"int_col":94,"int_col2":85,"varchar_col":"West Virginia"},{"int_col":95,"int_col2":86,"varchar_col":"Wisconsin"},{"int_col":96,"int_col2":87,"varchar_col":"Wyoming"},{"int_col":97,"int_col2":88,"varchar_col":"Montana"},{"int_col":28,"int_col2":19,"varchar_col":"New York"},{"int_col":29,"int_col2":20,"varchar_col":"North Carolina"}]}
# now switch two query pstmts and one delete pstmt
# pstmt1 = delete on table1, pstmt2 = query on table1, pstmt3 = query on table2
{"resource":"preparedStatement","action":"close","statementId":"pstmt1"}
{"resource":"preparedStatement","action":"close","statementId":"pstmt2"}
{"resource":"preparedStatement","action":"create","statementId":"pstmt1","sql":"DELETE FROM test1 WHERE varchar_col2 = ?"}
{"resource":"preparedStatement","action":"create","statementId":"pstmt2","sql":"select * from test1"}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"VARCHAR","value":"Utah"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","expectedResults":[{"int_col":93,"varchar_col":"Vermont","char_col":"Michigan            ","varchar_col2":"South Dakota"},{"int_col":94,"varchar_col":"Virgina","char_col":"Minnesota           ","varchar_col2":"Tennessee"},{"int_col":95,"varchar_col":"Washington","char_col":"Mississippi         ","varchar_col2":"Texas"},{"int_col":97,"varchar_col":"Wisconsin","char_col":"Alabama             ","varchar_col2":"Vermont"},{"int_col":98,"varchar_col":"Wyoming","char_col":"Alaska              ","varchar_col2":"Virgina"},{"int_col":99,"varchar_col":"Montana","char_col":"Arizona             ","varchar_col2":"Washington"},{"int_col":0,"varchar_col":"Nebraska","char_col":"Arkansas            ","varchar_col2":"West Virginia"},{"int_col":1,"varchar_col":"Nevada","char_col":"California          ","varchar_col2":"Wisconsin"},{"int_col":2,"varchar_col":"New Hampshire","char_col":"Colorado            ","varchar_col2":"Wyoming"},{"int_col":34,"varchar_col":"Oklahoma","char_col":"Illinois            ","varchar_col2":"New York"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"VARCHAR","value":"Texas"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt3","expectedResults":[{"int_col":88,"int_col2":79,"varchar_col":"Tennessee"},{"int_col":89,"int_col2":80,"varchar_col":"Texas"},{"int_col":90,"int_col2":81,"varchar_col":"Utah"},{"int_col":91,"int_col2":82,"varchar_col":"Vermont"},{"int_col":92,"int_col2":83,"varchar_col":"Virgina"},{"int_col":93,"int_col2":84,"varchar_col":"Washington"},{"int_col":94,"int_col2":85,"varchar_col":"West Virginia"},{"int_col":95,"int_col2":86,"varchar_col":"Wisconsin"},{"int_col":96,"int_col2":87,"varchar_col":"Wyoming"},{"int_col":97,"int_col2":88,"varchar_col":"Montana"},{"int_col":28,"int_col2":19,"varchar_col":"New York"},{"int_col":29,"int_col2":20,"varchar_col":"North Carolina"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"VARCHAR","value":"Wyoming"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt1","bindings":[{"index":1,"type":"VARCHAR","value":"West Virginia"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt3","expectedResults":[{"int_col":88,"int_col2":79,"varchar_col":"Tennessee"},{"int_col":89,"int_col2":80,"varchar_col":"Texas"},{"int_col":90,"int_col2":81,"varchar_col":"Utah"},{"int_col":91,"int_col2":82,"varchar_col":"Vermont"},{"int_col":92,"int_col2":83,"varchar_col":"Virgina"},{"int_col":93,"int_col2":84,"varchar_col":"Washington"},{"int_col":94,"int_col2":85,"varchar_col":"West Virginia"},{"int_col":95,"int_col2":86,"varchar_col":"Wisconsin"},{"int_col":96,"int_col2":87,"varchar_col":"Wyoming"},{"int_col":97,"int_col2":88,"varchar_col":"Montana"},{"int_col":28,"int_col2":19,"varchar_col":"New York"},{"int_col":29,"int_col2":20,"varchar_col":"North Carolina"}]}
{"resource":"preparedStatement","action":"execute","statementId":"pstmt2","expectedResults":[{"int_col":93,"varchar_col":"Vermont","char_col":"Michigan            ","varchar_col2":"South Dakota"},{"int_col":94,"varchar_col":"Virgina","char_col":"Minnesota           ","varchar_col2":"Tennessee"},{"int_col":97,"varchar_col":"Wisconsin","char_col":"Alabama             ","varchar_col2":"Vermont"},{"int_col":98,"varchar_col":"Wyoming","char_col":"Alaska              ","varchar_col2":"Virgina"},{"int_col":99,"varchar_col":"Montana","char_col":"Arizona             ","varchar_col2":"Washington"},{"int_col":1,"varchar_col":"Nevada","char_col":"California          ","varchar_col2":"Wisconsin"},{"int_col":34,"varchar_col":"Oklahoma","char_col":"Illinois            ","varchar_col2":"New York"}]}
# close prepared statements
{"resource":"preparedStatement","action":"close","statementId":"pstmt1"}
{"resource":"preparedStatement","action":"close","statementId":"pstmt2"}
{"resource":"preparedStatement","action":"close","statementId":"pstmt3"}
{"resource":"statement","action":"execute","statementId":"ddl","sql":"DROP TABLE IF EXISTS test1"}
{"resource":"statement","action":"execute","statementId":"ddl","sql":"DROP TABLE IF EXISTS test2"}
{"resource":"statement","action":"close","statementId":"ddl"}
{"resource":"session","action":"close","sessionId":"testPstmt"}
{"resource":"credentials","action":"close","credentialId":"test"}
# end of test: test for interleaving multiple prepared statements
